# Prompt Forge 产品需求文档

## 概述

本产品需求文档（PRD）概述了 Prompt Forge 的开发规范，这是一个提示词调试工具，旨在促进跨多个大型语言模型（LLM）的提示词同时测试和比较。该文档作为开发团队、利益相关者和质量保证的综合指南，确保成功交付一个简化 LLM 提示词优化工作流程的工具。

## 1. 引言

在大型语言模型时代，提示词工程已成为一项关键技能，然而跨多个提供商测试提示词仍然是一个分散且耗时的过程。Prompt Forge 通过提供同时提示词测试的统一平台来解决这一挑战，使开发者、研究人员和 AI 从业者能够高效地比较来自各种 LLM 提供商的响应，包括 OpenAI、Claude、Google Gemini 和 Ollama。

本文档建立了构建客户端 Web 应用程序的产品需求，该应用程序优先考虑性能、可访问性和用户体验，同时通过仅本地存储维护完整的数据隐私。

## 2. 产品概述

Prompt Forge 是一个渐进式 Web 应用程序（PWA），使用户能够同时向多个 LLM 提供商提交单个提示词，并在统一的时间线界面中查看结果。该应用程序支持基于文本的提示词和图像生成请求，为跨不同模型类型和功能的提示词测试提供全面解决方案。

### 2.1 核心价值主张

- **统一测试**：同时向多个 LLM 提交一个提示词
- **快速比较**：在时间线界面中并排查看结果
- **完全隐私**：所有数据本地存储，无服务器端持久化
- **跨平台**：PWA 在桌面和移动设备上可访问
- **离线功能**：核心功能无需互联网连接即可使用

### 2.2 关键差异化因素

- 零服务器端数据存储确保完整用户隐私
- 针对不同屏幕尺寸优化的响应式瀑布流时间线
- 结果可用时的实时流式传输
- 具有高级过滤和搜索功能的本地持久化

## 3. 目标和宗旨

### 3.1 主要目标

- **简化提示词测试**：通过 80% 减少在不同 LLM 提供商界面之间切换所花费的时间
- **增强比较效率**：启用最多 10 个不同模型响应的并排比较
- **确保数据隐私**：实现 100% 本地数据存储，无服务器端持久化
- **实现性能卓越**：在中端移动设备上保持低于 1.5 秒的首次内容绘制

### 3.2 次要目标

- **可访问性合规**：实现 WCAG 2.2 AA 合规以获得包容性用户体验
- **PWA 卓越**：获得 100% Lighthouse PWA 分数
- **用户留存**：提供离线功能以鼓励常规使用
- **可扩展性**：设计适配器架构以轻松集成新的 LLM 提供商

### 3.3 成功指标

- **性能**：首次内容绘制 < 1.5 秒
- **可访问性**：WCAG 2.2 AA 合规分数为 100%
- **PWA**：Lighthouse PWA 分数为 100%
- **可用性**：核心工作流程的任务完成率 > 95%
- **数据安全**：零数据传输到外部服务器（不包括 LLM API 调用）

## 4. 目标受众

### 4.1 主要用户

**AI/ML 开发者和工程师**
- 经验水平：中级到高级
- 用例：为生产应用程序优化提示词
- 痛点：跨提供商的耗时手动测试
- 目标：高效的提示词迭代和模型选择

**提示词工程师和研究人员**
- 经验水平：高级
- 用例：研究和实验不同的 LLM 功能
- 痛点：缺乏系统性比较工具
- 目标：模型响应和行为的详细分析

### 4.2 次要用户

**内容创作者和营销人员**
- 经验水平：初级到中级
- 用例：测试内容生成的创意提示词
- 痛点：不确定哪个模型产生最佳结果
- 目标：一致、高质量的内容生成

**教育者和学生**
- 经验水平：初级到中级
- 用例：学习 LLM 功能和局限性
- 痛点：比较多个模型的访问有限
- 目标：理解模型差异和提示词工程原理

### 4.3 用户画像

**画像 1：Alex - 高级 AI 开发者**
- 5+ 年 AI/ML 经验
- 在构建 AI 驱动产品的科技初创公司工作
- 需要为成本和性能优化提示词
- 重视效率和技术准确性

**画像 2：Morgan - 提示词工程研究员**
- 计算机科学博士，专门研究 NLP
- 进行提示词有效性研究
- 需要详细的比较和分析功能
- 重视全面的数据和导出功能

## 5. 功能和需求

### 5.1 核心功能

**多模型提示词执行**
- 同时提交到选定的 LLM 提供商
- 响应可用时的实时流式传输
- 支持文本和图像生成提示词
- 每个提供商的可配置模型参数

**时间线界面**
- 所有提示词提交和响应的时间顺序显示
- 响应式瀑布流网格布局（基于屏幕尺寸的 1/2/4 列）
- 带有基于光标分页的无限滚动
- 新响应到达时的实时更新

**结果管理**
- 提示词和响应的复制功能
- 使用相同模型配置的快速重试功能
- 生成图像的下载功能
- 带有元数据的详细结果模态框

**过滤和搜索**
- 按日期范围、状态、模型和提供商过滤
- 具有实时结果的可组合过滤器
- 在提示词文本和响应内搜索
- 按创建时间、模型或状态排序

**本地数据持久化**
- 所有提示词和响应的 IndexedDB 存储
- 用户偏好和过滤器的自动保存
- 数据导出/导入功能
- API 密钥的安全本地存储

### 5.2 高级功能

**提供商管理**
- 动态提供商选择界面
- 具有本地加密的 API 密钥管理
- 提供商特定的配置选项
- 失败请求的错误处理和重试逻辑

**图像生成支持**
- 生成图像的缩略图网格显示
- 点击下载功能
- 图像元数据显示（尺寸、质量、模型）
- 批量下载选项

**可访问性功能**
- 完整的键盘导航支持
- 屏幕阅读器兼容性
- 高对比度模式支持
- 模态框和动态内容的焦点管理

## 6. 用户故事和验收标准

### 6.1 身份验证和安全

**ST-101：API 密钥管理**
作为用户，我希望在本地安全存储我的 LLM 提供商 API 密钥，这样我就可以访问多个服务而无需重复输入凭据。

*验收标准：*
- 用户可以通过设置界面为支持的提供商添加 API 密钥
- API 密钥在存储到浏览器本地存储之前进行加密
- 用户可以更新或删除存储的 API 密钥
- 应用程序在存储前验证 API 密钥格式
- 除了预期的 LLM 提供商外，不会将 API 密钥传输到任何服务器

**ST-102：数据隐私**
作为用户，我希望确保我的提示词和响应永远不会存储在外部服务器上，这样我就可以完全控制我的数据。

*验收标准：*
- 所有数据仅存储在浏览器的 IndexedDB 中
- 不收集分析或遥测数据
- 向用户显示清晰的隐私声明
- 数据导出功能允许用户在本地备份数据

### 6.2 核心功能

**ST-103：文本提示词提交**
作为提示词工程师，我希望同时向多个 LLM 提供商提交文本提示词，这样我就可以快速比较它们的响应。

*验收标准：*
- 用户可以输入最多 10,000 个字符的文本提示词
- 用户可以从可用选项中选择一个或多个 LLM 提供商
- 提示词同时提交到所有选定的提供商
- 加载指示器显示每个提供商的提交进度
- 响应在可用时流入时间线

**ST-104：图像生成请求**
作为内容创作者，我希望使用跨多个提供商的提示词生成图像，这样我就可以比较视觉输出。

*验收标准：*
- 用户可以在文本和图像生成模式之间切换
- 图像提示词支持提供商特定的参数（尺寸、质量、风格）
- 生成的图像在结果卡中显示为缩略图
- 用户可以点击缩略图下载全分辨率图像
- 图像元数据被保留和显示

**ST-105：响应时间线**
作为用户，我希望在时间顺序时间线中查看我的所有提示词提交，这样我就可以跟踪我的测试历史。

*验收标准：*
- 时间线首先显示最近的提交
- 每个条目显示提示词文本、时间戳和提供商响应
- 时间线实现无限滚动以提高性能
- 响应式设计适应屏幕尺寸（1/2/4 列布局）
- 为待处理响应显示加载状态

**ST-106：结果过滤**
作为研究人员，我希望通过各种标准过滤我的提示词历史，这样我就可以快速找到特定的实验。

*验收标准：*
- 过滤选项包括日期范围、提供商、模型和状态
- 可以同时应用多个过滤器
- 过滤器状态在浏览器会话中持续存在
- 清除过滤器选项重置所有活动过滤器
- 过滤器结果实时更新

**ST-107：复制和重试功能**
作为开发者，我希望复制提示词和响应并重试以前的提示词，这样我就可以高效地迭代我的测试。

*验收标准：*
- 提示词和响应都有复制按钮
- 复制的内容保持原始格式
- 重试按钮将提示词重新提交到同一组提供商
- 重试保留原始模型参数
- 视觉反馈确认复制和重试操作

### 6.3 高级功能

**ST-108：提供商配置**
作为高级用户，我希望为每个提供商配置模型特定的参数，这样我就可以测试不同的模型配置。

*验收标准：*
- 提供商选择界面显示每个提供商的可用模型
- 模型特定选项（温度、最大令牌等）可配置
- 配置表单使用验证来防止无效参数
- 设置按提供商保存并在会话中持续存在
- 为新用户提供默认配置

**ST-109：图像结果管理**
作为设计师，我希望高效地查看和管理生成的图像，这样我就可以快速访问和下载我需要的图像。

*验收标准：*
- 图像在结果卡内的缩略图网格中显示
- 点击任何图像启动使用原始文件名的下载
- 详细信息模态框显示所有图像和元数据
- 多个图像的批量下载选项
- 图像加载通过懒加载优化

**ST-110：离线功能**
作为移动用户，我希望离线访问我以前的提示词和响应，这样我就可以在没有互联网连接的情况下查看我的工作。

*验收标准：*
- 以前加载的内容可离线访问
- 过滤和搜索在缓存数据上工作
- 当新提交需要互联网连接时有清晰指示
- 离线指示器显示当前连接状态
- 连接恢复时进行数据同步

### 6.4 数据管理

**ST-111：数据持久化**
作为用户，我希望我的提示词、响应和设置自动保存，这样我就不会丢失我的工作。

*验收标准：*
- 所有数据自动保存到 IndexedDB
- 不需要手动保存操作
- 数据在浏览器会话中持续存在
- 应用程序从存储错误中优雅恢复
- 存储使用经过优化以防止配额问题

**ST-112：数据导出和导入**
作为研究人员，我希望导出我的提示词数据，这样我就可以备份我的实验并与同事分享结果。

*验收标准：*
- 导出功能生成包含所有用户数据的 JSON 文件
- 导出包括提示词、响应、时间戳和元数据
- 导入功能从导出的 JSON 文件恢复数据
- 数据验证确保导入数据完整性
- 导入期间数据覆盖的清晰警告

**ST-113：数据清理**
作为用户，我希望管理我的存储数据，这样我就可以在需要时释放浏览器存储空间。

*验收标准：*
- 清除数据选项删除所有存储信息
- 确认对话框防止意外数据丢失
- 按日期范围或提供商的选择性删除
- 存储使用指示器显示当前空间利用率
- 数据清理保留用户偏好和 API 密钥

### 6.5 错误处理和边缘情况

**ST-114：网络错误处理**
作为用户，当网络请求失败时，我希望得到清晰的反馈，这样我就能理解出了什么问题并采取适当的行动。

*验收标准：*
- 网络错误显示用户友好的消息
- 为失败的请求提供重试选项
- 不同的错误类型（超时、认证、速率限制）有特定的消息
- 失败的请求在时间线中被清楚标记
- 错误日志可用于故障排除

**ST-115：大响应处理**
作为用户，我希望应用程序高效处理非常长的响应，这样性能保持流畅。

*验收标准：*
- 长响应被截断并提供"显示更多"选项
- 虚拟滚动防止性能下降
- 大图像被压缩用于缩略图显示
- 内存使用针对大数据集进行优化
- 资源问题的性能监控警报

## 7. 技术需求 / 技术栈

### 7.1 前端框架和核心技术

**框架**：Next.js 15 与 App Router
- React 服务器组件用于优化渲染
- 内置性能优化和代码分割
- 静态生成功能以改善加载时间

**样式和 UI 组件**
- TailwindCSS 用于实用优先的样式方法
- shadcn/ui 组件库用于一致的设计系统
- Lucide Icons 用于可缩放矢量图标
- Framer Motion 用于微妙的动画和过渡

**状态管理和数据持久化**
- React Context API 用于应用程序范围的状态管理
- Zustand 用于复杂的 UI 状态需求
- 通过 Dexie.js 的 IndexedDB 用于结构化本地数据存储
- 本地存储用于用户偏好和设置

### 7.2 表单处理和验证

**表单管理**
- React Hook Form 用于高性能表单处理
- Zod 用于运行时类型验证和模式定义
- 根据选定提供商调整的自适应表单
- 具有用户友好错误消息的实时验证

### 7.3 LLM 集成架构

**提供商适配器模式**
- 抽象提供商特定实现的统一接口
- 用于轻松添加新提供商的模块化架构
- 跨所有提供商的标准化请求/响应格式
- 内置重试逻辑和错误处理

**支持的提供商**
- OpenAI（GPT-4、GPT-3.5、DALL-E）
- Anthropic Claude（Claude-3、Claude-2）
- Google Gemini（Gemini Pro、Gemini Vision）
- Ollama（本地模型支持）
- 用于未来提供商添加的可扩展架构

### 7.4 性能和优化

**Core Web Vitals 优化**
- 首次内容绘制目标：< 1.5 秒
- 最大内容绘制目标：< 2.5 秒
- 累积布局偏移目标：< 0.1
- 首次输入延迟目标：< 100ms

**优化策略**
- 图像懒加载和渐进增强
- 大数据集的虚拟滚动
- 代码分割和动态导入
- Service Worker 实现缓存
- 包大小优化和树摇

### 7.5 渐进式 Web 应用需求

**PWA 功能**
- Service Worker 用于离线功能
- Web 应用清单用于安装功能
- 排队请求的后台同步
- 完成请求的推送通知（可选）

**Lighthouse 目标**
- 性能：100/100
- 可访问性：100/100
- 最佳实践：100/100
- SEO：100/100
- PWA：100/100

### 7.6 安全和隐私

**数据安全**
- 存储的 API 密钥的客户端加密
- 除了向 LLM 提供商外，没有服务器端数据传输
- 内容安全策略实现
- XSS 和注入攻击防护

**隐私合规**
- 没有分析或跟踪脚本
- 仅本地数据存储
- 清晰的隐私政策和数据处理文档
- 用户对所有存储数据的控制

### 7.7 浏览器兼容性

**支持的浏览器**
- Chrome/Chromium 90+
- Firefox 88+
- Safari 14+
- Edge 90+

**功能检测**
- 高级功能的渐进增强
- 不支持功能的优雅降级
- 关键缺失功能的 Polyfills

## 8. 设计和用户界面

### 8.1 设计原则

**视觉设计理念**
- 专注于内容可读性的简洁、最小界面
- 使用 TailwindCSS 设计令牌的现代设计语言
- 一致的间距和排版比例
- 微妙使用颜色来指示状态和层次结构

**可访问性优先设计**
- 超过 WCAG 2.2 AA 标准的高对比度比率
- 支持 200% 缩放的可缩放排版
- 键盘导航的焦点指示器
- 屏幕阅读器优化的内容结构

### 8.2 布局和导航

**头部导航**
- 徽标和应用程序标题
- 模式切换器（文本/图像生成）
- 提供商选择控件
- 设置和帮助访问

**主内容区域**
- 带有搜索和过滤控件的过滤器栏
- 带有无限滚动的时间线容器
- 响应式瀑布流网格布局
- 加载状态和空状态插图

**模态框和覆盖层设计**
- 扩展视图的结果详细模态框
- 配置的设置覆盖层
- 破坏性操作的确认对话框
- 用户反馈的 Toast 通知

### 8.3 响应式设计规范

**移动设备（320px - 768px）**
- 单列时间线布局
- 可折叠过滤控件
- 触控优化的交互目标（最小 44px）
- 导航的滑动手势

**平板电脑（768px - 1024px）**
- 两列时间线布局
- 扩展的过滤侧边栏
- 混合触控和鼠标交互支持
- 针对纵向和横向方向优化

**桌面（1024px+）**
- 四列时间线布局
- 带有高级选项的完整过滤侧边栏
- 高级用户的键盘快捷键
- 悬停状态和高级交互

### 8.4 组件规范

**时间线结果卡**
- 具有清晰视觉层次结构的紧凑卡片设计
- 提供商/模型识别徽章
- 状态指示器（加载、成功、错误）
- 操作按钮（复制、重试、详细信息）
- 带有展开选项的响应式文本截断

**过滤界面**
- 带有预设选项的日期范围选择器
- 多选提供商和模型过滤器
- 带有视觉指示器的状态过滤器
- 带有自动建议的搜索输入
- 清除所有过滤器操作

**图像结果显示**
- 带有纵横比保持的缩略图网格
- 加载占位符和错误状态
- 点击下载交互
- 悬停时的元数据覆盖
- 详细查看的缩放功能

### 8.5 可访问性规范

**键盘导航**
- Tab 顺序遵循逻辑内容流
- 主要内容区域的跳转链接
- 模态框和动态内容的焦点管理
- 常用操作的键盘快捷键

**屏幕阅读器支持**
- 具有适当地标的语义 HTML 结构
- 复杂交互的 ARIA 标签和描述
- 动态内容更新的实时区域
- 所有图像和图标的替代文本

**视觉可访问性**
- 正常文本的最小 4.5:1 对比度比率
- 大文本和 UI 元素的最小 3:1 对比度比率
- 颜色不是传达信息的唯一手段
- 文本在 200% 缩放级别保持可读

### 8.6 性能考虑

**渲染优化**
- 时间线性能的虚拟滚动
- 使用交叉观察器的图像懒加载
- 去抖搜索和过滤输入
- 使用 React.memo 和 useMemo 优化重新渲染

**动画和运动**
- 尊重用户的运动偏好
- 状态变化的微妙过渡
- 使用 transform 和 opacity 的性能优化动画
- 可访问性的减少运动回退

**加载状态**
- 初始内容加载的骨架屏幕
- 带有模糊技术的渐进图像加载
- 实时响应的流式内容更新
- 适当情况下的乐观 UI 更新